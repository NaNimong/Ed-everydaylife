<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Dinner Menu Recommender : Action</title>
    <style>
        :root {
            --primary-color: #ff6b6b;
            --secondary-color: #4ecdc4;
            --bg-color: #f0f2f5;
            --text-color: #2d3436;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Pretendard', 'Segoe UI', 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background: var(--card-bg);
            width: 100%;
            max-width: 600px;
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        h1 { margin-bottom: 10px; font-size: 2rem; color: #333; }
        .emoji-header { font-size: 3.5rem; margin-bottom: 15px; display: block; }
        p.subtitle { color: #636e72; margin-bottom: 40px; line-height: 1.6; }

        /* Buttons */
        .btn {
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), #ff8787);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6); }

        .btn-lang {
            background: white;
            border: 2px solid #eee;
            color: #333;
            width: 100%;
            max-width: 250px;
            display: block;
            margin: 15px auto;
        }
        .btn-lang:hover { border-color: var(--secondary-color); color: var(--secondary-color); }

        /* Question Section */
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .progress-bar { width: 100%; height: 6px; background-color: #eee; border-radius: 10px; margin-bottom: 30px; overflow: hidden; }
        .progress-fill { height: 100%; background-color: var(--secondary-color); width: 0%; transition: width 0.3s ease; }

        .question-text { font-size: 1.3rem; font-weight: 700; margin-bottom: 40px; min-height: 60px; display: flex; align-items: center; justify-content: center; word-break: keep-all;}
        .options-wrapper { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; position: relative; }
        .options-wrapper::before { content: ''; position: absolute; top: 50%; left: 10px; right: 10px; height: 2px; background: #e0e0e0; z-index: 0; transform: translateY(-50%); }
        .option-btn { width: 55px; height: 55px; border-radius: 50%; border: 3px solid #fff; background: #f1f3f5; color: #868e96; font-weight: bold; font-size: 1.2rem; cursor: pointer; z-index: 1; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
        .option-btn:hover { background-color: var(--secondary-color); color: white; transform: scale(1.1); }
        .labels { display: flex; justify-content: space-between; font-size: 0.9rem; color: #adb5bd; font-weight: 500; margin-bottom: 20px; }

        /* Result Section & Card */
        .food-card { 
            display: flex; background: #fff; border-radius: 16px; margin-bottom: 20px; overflow: hidden; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.03); text-align: left; 
            cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; position: relative;
        }
        .food-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(78, 205, 196, 0.4); border: 1px solid var(--secondary-color); }
        /* Add a "Click me" indicator */
        .food-card::after {
            content: 'ğŸ‘†';
            position: absolute; top: 10px; right: 10px; opacity: 0; transition: opacity 0.3s;
        }
        .food-card:hover::after { opacity: 1; }

        .food-img { width: 110px; height: 110px; min-height: 100%; object-fit: cover; background-color: #eee; }
        .food-info { padding: 16px; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .cuisine-tag { font-size: 0.7rem; padding: 3px 8px; border-radius: 6px; margin-right: 8px; font-weight: bold; color: white; display: inline-block; vertical-align: middle; }
        
        .tag-kr { background-color: #ff6b6b; } 
        .tag-cn { background-color: #d63031; } 
        .tag-jp { background-color: #fdcb6e; color: #333; } 
        .tag-asia { background-color: #00b894; } 
        .tag-us { background-color: #0984e3; } 
        .tag-mx { background-color: #e17055; } 

        .food-name { font-size: 1.2rem; font-weight: 800; color: #2d3436; vertical-align: middle; }
        .food-reason { font-size: 0.85rem; color: var(--secondary-color); font-weight: 600; margin: 4px 0; }
        .food-desc { font-size: 0.8rem; color: #636e72; line-height: 1.3; }

        .retry-btn { background-color: #2d3436; color: white; border: none; padding: 14px 30px; border-radius: 50px; cursor: pointer; margin-top: 20px; font-weight: bold; }

        /* Modal (Popup) Styles */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5); z-index: 100; backdrop-filter: blur(5px);
            align-items: center; justify-content: center; animation: fadeIn 0.3s;
        }
        .modal-box {
            background: white; width: 90%; max-width: 400px; padding: 30px; border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3); text-align: center; position: relative;
        }
        .modal-close {
            position: absolute; top: 15px; right: 20px; font-size: 1.5rem; cursor: pointer; color: #aaa;
        }
        .modal-close:hover { color: #333; }
        .modal-title { margin-bottom: 20px; color: var(--text-color); }
        .modal-btn {
            display: block; width: 100%; padding: 15px; margin-bottom: 10px; border: none; border-radius: 12px;
            font-size: 1rem; font-weight: bold; cursor: pointer; transition: background 0.2s;
        }
        .btn-recipe { background-color: #ff0000; color: white; } /* YouTube Red */
        .btn-recipe:hover { background-color: #cc0000; }
        .btn-map { background-color: #4285F4; color: white; } /* Google Blue */
        .btn-map:hover { background-color: #3367D6; }

    </style>
</head>
<body>

<div class="container">
    
    <div id="langScreen" class="section active">
        <span class="emoji-header">ğŸŒ</span>
        <h1>Select Language</h1>
        <p class="subtitle">Please choose your preferred language.<br>ì–¸ì–´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
        <button class="btn btn-lang" onclick="setLanguage('ko')">ğŸ‡°ğŸ‡· í•œêµ­ì–´ (Korean)</button>
        <button class="btn btn-lang" onclick="setLanguage('en')">ğŸ‡ºğŸ‡¸ English</button>
    </div>

    <div id="startScreen" class="section">
        <span class="emoji-header">ğŸ½ï¸</span>
        <h1 id="startTitle"></h1>
        <p class="subtitle" id="startDesc"></p>
        <button class="btn btn-primary" onclick="startSurvey()" id="startBtn"></button>
    </div>

    <div id="questionScreen" class="section">
        <div class="progress-bar"><div class="progress-fill" id="progressBar"></div></div>
        <div style="color:var(--secondary-color); font-weight:bold; font-size:0.9rem; margin-bottom:10px;">Q<span id="currentQNum">1</span>.</div>
        <div class="question-text" id="questionText"></div>
        
        <div class="options-wrapper">
            <button class="option-btn" onclick="selectOption(1)">1</button>
            <button class="option-btn" onclick="selectOption(2)">2</button>
            <button class="option-btn" onclick="selectOption(3)">3</button>
            <button class="option-btn" onclick="selectOption(4)">4</button>
            <button class="option-btn" onclick="selectOption(5)">5</button>
        </div>
        
        <div class="labels">
            <span id="labelLow"></span>
            <span id="labelHigh"></span>
        </div>
    </div>

    <div id="resultScreen" class="section">
        <h2 id="resultTitle" style="margin-bottom: 25px;"></h2>
        <p id="clickHint" style="color:#888; font-size:0.9rem; margin-bottom:20px;"></p>
        <div id="resultList"></div>
        <div style="text-align: center;">
            <button class="retry-btn" onclick="location.reload()" id="retryBtn"></button>
        </div>
    </div>
</div>

<div id="actionModal" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <h2 class="modal-title" id="modalFoodName">Food Name</h2>
        <p id="modalDesc" style="color:#666; margin-bottom:20px; font-size:0.9rem;"></p>
        
        <button class="modal-btn btn-recipe" onclick="goRecipe()">
            â–¶ï¸ <span id="btnRecipeText">YouTube Recipe</span>
        </button>
        <button class="modal-btn btn-map" onclick="goMap()">
            ğŸ“ <span id="btnMapText">Find Restaurant</span>
        </button>
    </div>
</div>

<script>
    // --- Data & Configuration ---
    let currentLang = 'ko'; 
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let selectedFoodItem = null; // Store clicked food data

    // UI Text Resources
    const uiText = {
        startTitle: { ko: "ì˜¤ëŠ˜ ë­ ë¨¹ì§€?", en: "What's for Dinner?" },
        startDesc: { ko: "120ê°€ì§€ ë©”ë‰´ ì¤‘ ë‹¹ì‹ ì˜ ì…ë§›ì— ë”± ë§ëŠ”<br>ìµœê³ ì˜ ì €ë… ë©”ë‰´ë¥¼ ì¶”ì²œí•´ ë“œë¦½ë‹ˆë‹¤.", en: "Discover your perfect dinner match<br>from over 120 global menu options." },
        startBtn: { ko: "ì¶”ì²œ ë°›ê¸° ì‹œì‘", en: "Start Recommendation" },
        resultTitle: { ko: "ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë©”ë‰´ TOP 5", en: "Top 5 Recommendations" },
        clickHint: { ko: "ìŒì‹ì„ í´ë¦­í•˜ë©´ ë ˆì‹œí”¼ë‚˜ ì‹ë‹¹ì„ ì°¾ì„ ìˆ˜ ìˆì–´ìš”! ğŸ‘‡", en: "Click a card to find a recipe or restaurant! ğŸ‘‡" },
        retryBtn: { ko: "ë‹¤ì‹œ ì‹œì‘í•˜ê¸°", en: "Try Again" },
        btnRecipe: { ko: "ë ˆì‹œí”¼ ë³´ê¸° (YouTube)", en: "Watch Recipe (YouTube)" },
        btnMap: { ko: "ì£¼ë³€ ì‹ë‹¹ ì°¾ê¸° (Google Maps)", en: "Find Restaurant (Google Maps)" },
        labels: {
            low: { ko: "ê·¸ë ‡ì§€ ì•Šë‹¤", en: "No / Low" },
            high: { ko: "ë§¤ìš° ê·¸ë ‡ë‹¤", en: "Yes / High" }
        }
    };

    const categories = {
        'kr': { ko: "í•œì‹", en: "Korean", class: "tag-kr" },
        'cn': { ko: "ì¤‘ì‹", en: "Chinese", class: "tag-cn" },
        'jp': { ko: "ì¼ì‹", en: "Japanese", class: "tag-jp" },
        'asia': { ko: "ì•„ì‹œì•ˆ", en: "Asian", class: "tag-asia" },
        'mx': { ko: "ë©•ì‹œì¹¸", en: "Mexican", class: "tag-mx" },
        'us': { ko: "ì–‘ì‹", en: "Western", class: "tag-us" }
    };

    // Questions
    const questions = [
        { q: { ko: "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì¶¥ê±°ë‚˜ ë¹„ê°€ ì˜¤ë‚˜ìš”?", en: "Is the weather cold or rainy today?" }, low: { ko: "ë§‘ìŒ/ë”ì›€", en: "Hot/Sunny" }, high: { ko: "ì¶”ì›€/ë¹„", en: "Cold/Rainy" } },
        { q: { ko: "ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ì•„ ìê·¹ì ì¸ ë§›ì´ ë‹¹ê¸°ë‚˜ìš”?", en: "Do you crave spicy/strong food due to stress?" }, low: { ko: "í¸ì•ˆí•¨", en: "Comfort" }, high: { ko: "ìê·¹ì ", en: "Spicy/Strong" } },
        { q: { ko: "ì§€ê¸ˆ ì–¼ë§ˆë‚˜ ë°°ê°€ ê³ í”„ì‹ ê°€ìš”?", en: "How hungry are you right now?" }, low: { ko: "ì•½ê°„", en: "Snack" }, high: { ko: "ë§¤ìš°", en: "Feast" } },
        { q: { ko: "ë§¤ìš´ ìŒì‹ì„ ì˜ ë“œì‹œë‚˜ìš”?", en: "Do you enjoy spicy food?" }, low: { ko: "ëª» ë¨¹ìŒ", en: "Mild" }, high: { ko: "ë§¤ë‹ˆì•„", en: "Hot" } },
        { q: { ko: "êµ­ë¬¼ ìš”ë¦¬ë¥¼ ì„ í˜¸í•˜ì‹œë‚˜ìš”?", en: "Do you want a dish with soup?" }, low: { ko: "ê±´ì¡°í•œ ìš”ë¦¬", en: "Dry" }, high: { ko: "êµ­ë¬¼ ìš”ë¦¬", en: "Soup" } },
        { q: { ko: "ê¸°ë¦„ì§€ê±°ë‚˜ íŠ€ê¸´ ìŒì‹ì´ ë‹¹ê¸°ë‚˜ìš”?", en: "Do you crave greasy or fried food?" }, low: { ko: "ë‹´ë°±/ìƒí¼", en: "Light/Fresh" }, high: { ko: "ê¸°ë¦„ì§", en: "Greasy/Fried" } },
        { q: { ko: "ëˆ„êµ¬ì™€ í•¨ê»˜ ë“œì‹œë‚˜ìš”?", en: "Are you eating alone or with a group?" }, low: { ko: "í˜¼ë°¥", en: "Alone" }, high: { ko: "ì—¬ëŸ¿ì´", en: "Group" } },
        { q: { ko: "ë©´/ë¹µ vs ë°¥", en: "Noodles/Bread vs Rice" }, low: { ko: "ë©´/ë¹µ", en: "Noodles/Bread" }, high: { ko: "ë°¥", en: "Rice" } },
        { q: { ko: "ì´êµ­ì ì¸ í–¥ì‹ ë£Œ(ê³ ìˆ˜ ë“±)ë¥¼ ì¢‹ì•„í•˜ì‹œë‚˜ìš”?", en: "Do you like exotic spices (Cilantro, etc)?" }, low: { ko: "ìµìˆ™í•œ ë§›", en: "Familiar" }, high: { ko: "ì´êµ­ì ", en: "Exotic" } },
        { q: { ko: "ìŒì‹ì˜ ì˜¨ë„ëŠ”?", en: "Preferred food temperature?" }, low: { ko: "ì‹œì›í•¨", en: "Cold" }, high: { ko: "ëœ¨ê±°ì›€", en: "Hot" } }
    ];

    // Food Data
    const foodData = [
        { n: {ko:"ê¹€ì¹˜ì°Œê°œ", en:"Kimchi Stew"}, c:"kr", t:[5,4,4,4,5,3,2,5,1,5], d:{ko:"ì–¼í°í•œ êµ­ë¬¼ê³¼ ê¹€ì¹˜ì˜ ì¡°í™”", en:"Spicy soup with kimchi and pork."} },
        { n: {ko:"ì‚¼ê²¹ì‚´", en:"Samgyeopsal"}, c:"kr", t:[3,4,5,2,1,5,5,4,1,5], d:{ko:"í•œêµ­ì¸ì˜ ì†Œìš¸í‘¸ë“œ, êµ¬ìš´ ë¼ì§€ê³ ê¸°", en:"Grilled pork belly, Korean BBQ style."} },
        { n: {ko:"ë¹„ë¹”ë°¥", en:"Bibimbap"}, c:"kr", t:[2,2,4,3,2,2,2,5,1,3], d:{ko:"ê±´ê°•í•œ ì±„ì†Œì™€ ê³ ì¶”ì¥ì˜ ì¡°í™”", en:"Mixed rice with vegetables and chili paste."} },
        { n: {ko:"ë–¡ë³¶ì´", en:"Tteokbokki"}, c:"kr", t:[3,4,3,4,3,2,2,1,1,5], d:{ko:"ë§¤ì½¤ë‹¬ì½¤í•œ êµ­ë¯¼ ê°„ì‹", en:"Spicy and sweet stir-fried rice cakes."} },
        { n: {ko:"ì‚¼ê³„íƒ•", en:"Ginseng Chicken Soup"}, c:"kr", t:[5,1,5,1,5,2,3,5,1,5], d:{ko:"ê¸°ë ¥ íšŒë³µì— ì¢‹ì€ ë³´ì–‘ì‹", en:"Nutritious soup with a whole chicken and ginseng."} },
        { n: {ko:"ì¹˜í‚¨", en:"Fried Chicken"}, c:"kr", t:[3,5,4,2,1,5,5,1,1,5], d:{ko:"ë°”ì‚­í•œ íŠ€ê¹€ì˜·ê³¼ ë¶€ë“œëŸ¬ìš´ ì†ì‚´", en:"Crispy Korean style fried chicken."} },
        { n: {ko:"ëƒ‰ë©´", en:"Cold Noodles"}, c:"kr", t:[1,1,3,2,4,1,2,1,1,1], d:{ko:"ì‚´ì–¼ìŒ ë™ë™ ì‹œì›í•œ ìœ¡ìˆ˜", en:"Noodles in icy cold broth."} },
        { n: {ko:"ë¶ˆê³ ê¸°", en:"Bulgogi"}, c:"kr", t:[3,1,4,1,2,3,4,5,1,5], d:{ko:"ë‹¬ì½¤í•œ ê°„ì¥ ì–‘ë… ì†Œê³ ê¸°", en:"Marinated slices of beef grilled on a barbecue."} },
        { n: {ko:"ìˆœëŒ€êµ­ë°¥", en:"Sundae Gukbap"}, c:"kr", t:[5,3,5,2,5,3,1,5,1,5], d:{ko:"ì†ì´ ë“ ë“ í•´ì§€ëŠ” ëœ¨ê±°ìš´ êµ­ë°¥", en:"Hot soup with Korean blood sausage."} },
        
        { n: {ko:"ì§œì¥ë©´", en:"Jajangmyeon"}, c:"cn", t:[3,2,4,1,2,4,2,1,2,4], d:{ko:"ë‹¬ì½¤ ì§­ì§¤í•œ ì¶˜ì¥ ì†ŒìŠ¤ ë©´ìš”ë¦¬", en:"Noodles with black bean sauce."} },
        { n: {ko:"ì§¬ë½•", en:"Jjamppong"}, c:"cn", t:[5,4,4,5,5,4,2,1,2,5], d:{ko:"í•´ì‚°ë¬¼ì´ ë“¤ì–´ê°„ ì–¼í°í•œ êµ­ë¬¼", en:"Spicy noodle soup with seafood."} },
        { n: {ko:"ë§ˆë¼íƒ•", en:"Malatang"}, c:"cn", t:[4,5,4,5,5,5,3,1,4,5], d:{ko:"ì–¼ì–¼í•˜ê³  ì¤‘ë…ì„± ìˆëŠ” ë§¤ìš´ë§›", en:"Spicy numbing hot pot soup."} },
        { n: {ko:"íƒ•ìˆ˜ìœ¡", en:"Sweet and Sour Pork"}, c:"cn", t:[3,2,4,1,1,5,5,2,2,4], d:{ko:"ë°”ì‚­í•˜ê²Œ íŠ€ê¸´ ê³ ê¸°ì— ìƒˆì½¤ë‹¬ì½¤ ì†ŒìŠ¤", en:"Deep fried pork with sweet and sour sauce."} },
        { n: {ko:"í› ê¶ˆ", en:"Hot Pot"}, c:"cn", t:[5,4,5,4,5,4,5,1,4,5], d:{ko:"ë‹¤ì–‘í•œ ì¬ë£Œë¥¼ ìœ¡ìˆ˜ì— ìµí˜€ë¨¹ëŠ” ìš”ë¦¬", en:"Chinese simmering pot dish."} },
        { n: {ko:"ì–‘ê¼¬ì¹˜", en:"Lamb Skewers"}, c:"cn", t:[3,3,3,2,1,4,5,2,4,5], d:{ko:"ìˆ¯ë¶ˆì— êµ¬ìš´ í–¥ì‹ ë£Œ ì…íŒ ì–‘ê³ ê¸°", en:"Grilled lamb skewers with cumin."} },

        { n: {ko:"ì´ˆë°¥", en:"Sushi"}, c:"jp", t:[2,1,3,2,1,1,2,5,3,2], d:{ko:"ì‹ ì„ í•œ ì¬ë£Œë¥¼ ì–¹ì€ í•œì… ìš”ë¦¬", en:"Fresh raw fish over vinegared rice."} },
        { n: {ko:"ëˆì¹´ì¸ ", en:"Tonkatsu"}, c:"jp", t:[3,2,4,1,1,5,2,3,2,5], d:{ko:"ë‘íˆ¼í•˜ê³  ë°”ì‚­í•œ ì¼ë³¸ì‹ ë¼ì§€ íŠ€ê¹€", en:"Breaded, deep-fried pork cutlet."} },
        { n: {ko:"ë¼ë©˜", en:"Ramen"}, c:"jp", t:[5,2,4,2,5,4,2,1,3,5], d:{ko:"ì§„í•œ ìœ¡ìˆ˜ì™€ ì«„ê¹ƒí•œ ìƒë©´", en:"Japanese noodle soup."} },
        { n: {ko:"ìš°ë™", en:"Udon"}, c:"jp", t:[5,1,3,1,5,1,2,1,2,5], d:{ko:"ì˜¤ë™í†µí•œ ë©´ë°œê³¼ ë‹´ë°±í•œ êµ­ë¬¼", en:"Thick wheat flour noodle soup."} },
        { n: {ko:"ë©”ë°€ì†Œë°”", en:"Soba Noodles"}, c:"jp", t:[1,1,2,1,4,1,1,1,2,1], d:{ko:"ì‹œì›í•œ ì¯”ìœ ì— ì ì…” ë¨¹ëŠ” ë©´", en:"Buckwheat noodles with dipping sauce."} },
        { n: {ko:"í…ë™", en:"Tendong"}, c:"jp", t:[3,2,5,1,1,5,1,5,3,5], d:{ko:"ë°”ì‚­í•œ íŠ€ê¹€ì´ ì˜¬ë¼ê°„ ë®ë°¥", en:"Tempura rice bowl."} },

        { n: {ko:"ìŠ¤í…Œì´í¬", en:"Steak"}, c:"us", t:[3,1,4,1,1,4,5,2,2,5], d:{ko:"ìœ¡ì¦™ ê°€ë“í•œ ì†Œê³ ê¸° êµ¬ì´", en:"Juicy grilled beef steak."} },
        { n: {ko:"í† ë§ˆí†  íŒŒìŠ¤íƒ€", en:"Tomato Pasta"}, c:"us", t:[3,2,3,2,2,2,3,1,2,4], d:{ko:"ìƒí¼í•œ í† ë§ˆí†  ì†ŒìŠ¤ ìŠ¤íŒŒê²Œí‹°", en:"Pasta with tomato sauce."} },
        { n: {ko:"í”¼ì", en:"Pizza"}, c:"us", t:[3,2,5,1,1,5,5,1,2,5], d:{ko:"ì¹˜ì¦ˆê°€ ë“¬ë¿ ë“¤ì–´ê°„ íŒŒí‹° ìŒì‹", en:"Cheesy oven-baked flatbread."} },
        { n: {ko:"í–„ë²„ê±°", en:"Hamburger"}, c:"us", t:[2,3,4,1,1,4,2,1,2,4], d:{ko:"íŒ¨í‹°ì™€ ì±„ì†Œì˜ ì™„ë²½í•œ ë°¸ëŸ°ìŠ¤", en:"Sandwich with a ground meat patty."} },
        { n: {ko:"í¬ë¦¼ íŒŒìŠ¤íƒ€", en:"Carbonara"}, c:"us", t:[3,2,4,1,2,4,3,1,2,4], d:{ko:"ê³ ì†Œí•˜ê³  ë¶€ë“œëŸ¬ìš´ í¬ë¦¼ ì†ŒìŠ¤", en:"Creamy pasta with bacon and egg."} },
        { n: {ko:"ìƒëŸ¬ë“œ", en:"Salad"}, c:"us", t:[1,1,2,1,1,1,1,3,2,2], d:{ko:"ê°€ë³ê³  ì‹ ì„ í•œ ê±´ê°•ì‹", en:"Fresh vegetables and dressing."} },

        { n: {ko:"ìŒ€êµ­ìˆ˜", en:"Pho"}, c:"asia", t:[5,2,3,2,5,2,2,1,4,5], d:{ko:"ê¹Šì€ ìœ¡ìˆ˜ì™€ ì•„ì‚­í•œ ìˆ™ì£¼", en:"Vietnamese rice noodle soup."} },
        { n: {ko:"íŒŸíƒ€ì´", en:"Pad Thai"}, c:"asia", t:[3,2,3,2,1,4,3,1,4,5], d:{ko:"ìƒˆì½¤ë‹¬ì½¤í•œ íƒœêµ­ì‹ ë³¶ìŒë©´", en:"Thai stir-fried rice noodles."} },
        { n: {ko:"íƒ€ì½”", en:"Tacos"}, c:"mx", t:[2,2,3,3,1,3,3,1,5,4], d:{ko:"ë˜ë ì•„ì— ì‹¸ ë¨¹ëŠ” ë©•ì‹œì½”ì˜ ë§›", en:"Tortillas filled with meat and veggies."} },
        { n: {ko:"ë¸Œë¦¬ë˜", en:"Burrito"}, c:"mx", t:[2,2,5,2,1,5,1,5,5,4], d:{ko:"ë°¥ê³¼ ê³ ê¸°ë¡œ ì†ì„ ì±„ìš´ ë¡¤", en:"Flour tortilla wrapped with fillings."} },
        { n: {ko:"ë‚˜ì‹œê³ ë­", en:"Nasi Goreng"}, c:"asia", t:[3,2,4,3,1,4,2,5,4,5], d:{ko:"ì¸ë„ë„¤ì‹œì•„ ìŠ¤íƒ€ì¼ ë³¶ìŒë°¥", en:"Indonesian fried rice."} },
        { n: {ko:"ë¶„ì§œ", en:"Bun Cha"}, c:"asia", t:[2,1,3,1,2,2,3,1,4,3], d:{ko:"ìƒˆì½¤í•œ ì†ŒìŠ¤ì— ì°ì–´ë¨¹ëŠ” ë² íŠ¸ë‚¨ ìš”ë¦¬", en:"Grilled pork and noodles with dipping sauce."} },
        { n: {ko:"ë˜ ì–‘ê¿", en:"Tom Yum Goong"}, c:"asia", t:[4,4,3,4,5,3,3,2,5,5], d:{ko:"ë§¤ì½¤ ìƒˆì½¤í•œ íƒœêµ­ì‹ ìŠ¤í”„", en:"Spicy and sour Thai shrimp soup."} }
    ];

    // --- Logic ---

    function setLanguage(lang) {
        currentLang = lang;
        document.getElementById('langScreen').style.display = 'none';
        document.getElementById('startScreen').classList.add('active');
        updateText();
    }

    function updateText() {
        document.getElementById('startTitle').innerText = uiText.startTitle[currentLang];
        document.getElementById('startDesc').innerHTML = uiText.startDesc[currentLang];
        document.getElementById('startBtn').innerText = uiText.startBtn[currentLang];
        document.getElementById('resultTitle').innerText = uiText.resultTitle[currentLang];
        document.getElementById('clickHint').innerText = uiText.clickHint[currentLang];
        document.getElementById('retryBtn').innerText = uiText.retryBtn[currentLang];
        document.getElementById('btnRecipeText').innerText = uiText.btnRecipe[currentLang];
        document.getElementById('btnMapText').innerText = uiText.btnMap[currentLang];
        
        document.getElementById('labelLow').innerText = uiText.labels.low[currentLang];
        document.getElementById('labelHigh').innerText = uiText.labels.high[currentLang];
    }

    function startSurvey() {
        document.getElementById('startScreen').classList.remove('active');
        document.getElementById('questionScreen').classList.add('active');
        renderQuestion();
    }

    function renderQuestion() {
        const qData = questions[currentQuestionIndex];
        document.getElementById('currentQNum').innerText = currentQuestionIndex + 1;
        document.getElementById('questionText').innerText = qData.q[currentLang];
        document.getElementById('labelLow').innerText = qData.low[currentLang];
        document.getElementById('labelHigh').innerText = qData.high[currentLang];
        
        const progress = ((currentQuestionIndex) / questions.length) * 100;
        document.getElementById('progressBar').style.width = `${progress}%`;
    }

    function selectOption(value) {
        userAnswers.push(value);
        if (currentQuestionIndex < questions.length - 1) {
            currentQuestionIndex++;
            renderQuestion();
        } else {
            document.getElementById('progressBar').style.width = '100%';
            showResult();
        }
    }

    function getReason(food, answers) {
        const reasons = {
            spicy: { ko: "í™”ëˆí•œ ë§¤ìš´ë§›ì´ í•„ìš”í•œ ë‚ !", en: "Perfect for a spicy craving!" },
            mild: { ko: "ìê·¹ ì—†ì´ í¸ì•ˆí•œ ë§›.", en: "Mild and comforting flavor." },
            soup: { ko: "ëœ¨ëˆí•œ êµ­ë¬¼ì´ ìµœê³ ì£ .", en: "Hot soup is the best choice." },
            greasy: { ko: "ê¸°ë¦„ì§„ ìŒì‹ìœ¼ë¡œ ì—ë„ˆì§€ ì¶©ì „!", en: "Recharge with rich flavors!" },
            exotic: { ko: "ìƒˆë¡œìš´ ì´êµ­ì ì¸ ë§›ì˜ ë°œê²¬.", en: "Explore exotic tastes." },
            familiar: { ko: "ìµìˆ™í•´ì„œ ë” ë§›ìˆëŠ” ê·¸ ë§›.", en: "Familiar and delicious." },
            cold: { ko: "ì‹œì›í•˜ê²Œ ì¦ê¸°ëŠ” ë³„ë¯¸.", en: "Cool and refreshing." },
            match: { ko: "ë‹¹ì‹ ì˜ ì·¨í–¥ì„ ì €ê²©í•  ë©”ë‰´!", en: "Perfect match for your taste!" }
        };

        if (food.t[3] >= 4 && answers[3] >= 4) return reasons.spicy[currentLang];
        if (food.t[3] <= 2 && answers[3] <= 2) return reasons.mild[currentLang];
        if (food.t[4] >= 4 && answers[4] >= 4) return reasons.soup[currentLang];
        if (food.t[5] >= 4 && answers[5] >= 4) return reasons.greasy[currentLang];
        if (food.t[8] >= 4 && answers[8] >= 4) return reasons.exotic[currentLang];
        if (food.t[0] <= 2 && answers[0] <= 2) return reasons.cold[currentLang];
        return reasons.match[currentLang];
    }

    function showResult() {
        document.getElementById('questionScreen').classList.remove('active');
        document.getElementById('resultScreen').classList.add('active');

        const ranked = foodData.map(food => {
            let diff = 0;
            food.t.forEach((score, i) => diff += Math.abs(score - userAnswers[i]));
            return { ...food, score: diff };
        }).sort((a, b) => a.score - b.score);

        const top5 = ranked.slice(0, 5);
        const listContainer = document.getElementById('resultList');
        listContainer.innerHTML = "";

        top5.forEach((food) => {
            const cat = categories[food.c];
            const reason = getReason(food, userAnswers);
            const fname = food.n[currentLang];
            const fdesc = food.d[currentLang];
            
            const query = encodeURIComponent(food.n['en'] + " food dish"); 
            const imgUrl = `https://tse2.mm.bing.net/th?q=${query}&w=300&h=300&c=7&rs=1&p=0`;

            // element ìƒì„± í›„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (í´ë¡œì € ë¬¸ì œ í•´ê²°)
            const card = document.createElement('div');
            card.className = 'food-card';
            card.onclick = () => openModal(food);
            
            card.innerHTML = `
                <img src="${imgUrl}" alt="${fname}" class="food-img" onerror="this.src='https://via.placeholder.com/150?text=No+Image'">
                <div class="food-info">
                    <div>
                        <span class="cuisine-tag ${cat.class}">${cat[currentLang]}</span>
                        <span class="food-name">${fname}</span>
                    </div>
                    <div class="food-reason">ğŸ’¡ ${reason}</div>
                    <div class="food-desc">${fdesc}</div>
                </div>
            `;
            listContainer.appendChild(card);
        });
    }

    // --- Modal Logic ---

    function openModal(food) {
        selectedFoodItem = food;
        const modal = document.getElementById('actionModal');
        const modalTitle = document.getElementById('modalFoodName');
        const modalDesc = document.getElementById('modalDesc');

        modalTitle.innerText = food.n[currentLang];
        modalDesc.innerText = food.d[currentLang];
        
        modal.style.display = 'flex'; // Use flex to center
    }

    function closeModal() {
        document.getElementById('actionModal').style.display = 'none';
    }

    // Close modal if clicked outside
    window.onclick = function(event) {
        const modal = document.getElementById('actionModal');
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    function goRecipe() {
        if (!selectedFoodItem) return;
        // Search on YouTube (Video recipes are best)
        const query = encodeURIComponent(selectedFoodItem.n[currentLang] + (currentLang === 'ko' ? " ë ˆì‹œí”¼" : " recipe"));
        window.open(`https://www.youtube.com/results?search_query=${query}`, '_blank');
    }

    function goMap() {
        if (!selectedFoodItem) return;
        // Search on Google Maps
        // If Korean, add 'ë§›ì§‘' (tasty place), if English, add 'restaurant'
        const suffix = currentLang === 'ko' ? " ë§›ì§‘" : " restaurant";
        const query = encodeURIComponent(selectedFoodItem.n[currentLang] + suffix);
        
        // This URL format triggers a search near the user's current location
        window.open(`https://www.google.com/maps/search/?api=1&query=${query}`, '_blank');
    }

</script>

</body>
</html>